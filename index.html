<!DOCTYPE html>
<html lang="ar" dir="rtl" id="mainHtml">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Oren - Ø£ÙˆØ±ÙŠÙ†</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;800&display=swap');

        * { box-sizing: border-box; transition: all 0.3s ease; font-family: 'Poppins', sans-serif; }
        
        body {
            margin: 0;
            background: linear-gradient(135deg, #0f0c29 0%, #302b63 50%, #24243e 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            overflow-x: hidden;
        }

        /* --- Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø§ÙØªØªØ§Ø­ÙŠØ© Ø§Ù„Ø³ÙˆØ¯Ø© --- */
        #splash {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; display: flex; flex-direction: column;
            justify-content: center; align-items: center; z-index: 10000; transition: 1s ease-in-out;
        }
        .neon-logo {
            font-size: 60px; font-weight: 800; color: #fff; letter-spacing: 5px;
            animation: pulseGlow 1.5s ease-in-out infinite alternate;
        }
        @keyframes pulseGlow {
            from { text-shadow: 0 0 10px #fff, 0 0 20px #00d2ff, 0 0 30px #00d2ff; opacity: 1; }
            to { text-shadow: 0 0 5px #fff, 0 0 10px #00d2ff; opacity: 0.3; }
        }

        /* --- Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ù„ÙŠÙ„ÙŠ Ø§Ù„ÙØ®Ù… --- */
        .logo-text {
            font-size: 45px; font-weight: 800; letter-spacing: 3px;
            background: linear-gradient(to right, #00d2ff, #928dab);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            margin-bottom: 10px; text-transform: uppercase;
        }

        .container {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(15px);
            padding: 40px; border-radius: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 25px 50px rgba(0,0,0,0.3);
            width: 100%; max-width: 420px; text-align: center; color: white;
        }

        .input-group { margin-bottom: 18px; text-align: right; }
        label { display: block; margin-bottom: 8px; font-size: 13px; color: #00d2ff; font-weight: 600; }

        input, select, textarea {
            width: 100%; padding: 14px 20px; border: 1px solid rgba(255,255,255,0.2);
            border-radius: 15px; font-size: 15px; background: rgba(255,255,255,0.05);
            color: white; outline: none;
        }

        .main-btn {
            width: 100%; padding: 16px; background: linear-gradient(to right, #00d2ff, #3a7bd5);
            border: none; border-radius: 15px; color: white; font-size: 16px;
            font-weight: 600; cursor: pointer; margin-top: 10px;
        }

        .task-card {
            background: rgba(255, 255, 255, 0.05); border-right: 4px solid #00d2ff;
            padding: 15px; border-radius: 15px; margin-bottom: 15px; text-align: right;
        }

        .hidden { display: none; }
        .user-badge { font-size: 12px; background: rgba(0, 210, 255, 0.2); padding: 5px 12px; border-radius: 20px; margin-bottom: 20px; display: inline-block; }
    </style>
</head>
<body>

    <div id="splash">
        <div class="neon-logo">OREN</div>
        <p style="color: #444; letter-spacing: 3px; font-size: 12px; margin-top: 15px;">LOADING SYSTEM...</p>
    </div>

    <div class="container" id="loginScreen">
        <div class="logo-text">OREN</div>
        <h2 style="font-weight: 300; margin-bottom: 30px;">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>
        <div class="input-group"><input type="email" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" id="emailInput"></div>
        <div class="input-group"><input type="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" id="passInput"></div>
        <button class="main-btn" onclick="login()">Ø¯Ø®ÙˆÙ„</button>
    </div>

    <div class="container hidden" id="adminScreen">
        <div class="logo-text" style="font-size: 30px;">ADMIN</div>
        <div class="user-badge">ÙŠÙˆØ³Ù ğŸ‘‘</div>
        <div class="input-group"><label>Ø§Ù„Ø¹Ù…ÙŠÙ„</label><input type="text" id="cName"></div>
        <div class="input-group"><label>Ø§Ù„Ù‡Ø§ØªÙ</label><input type="tel" id="cPhone"></div>
        <div class="input-group"><label>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</label><input type="text" id="cAddr"></div>
        <div class="input-group"><label>Ø§Ù„Ù…Ø´ÙƒÙ„Ø©</label><textarea id="cIssue" rows="2"></textarea></div>
        <div class="input-group">
            <label>Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨</label>
            <select id="agentSelect"><option value="">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</option></select>
        </div>
        <button class="main-btn" onclick="assignTask()">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ù‡Ù…Ø©</button>
        <button onclick="logout()" style="background:none; border:none; color:#ff4757; cursor:pointer; margin-top:10px;">Ø®Ø±ÙˆØ¬</button>
    </div>

    <div class="container hidden" id="agentScreen">
        <div class="logo-text" style="font-size: 30px;">TASKS</div>
        <div id="tasksList"></div>
        <button class="main-btn" style="background:#555" onclick="logout()">Ø®Ø±ÙˆØ¬</button>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyALgV2v3lmxvEoP0HosqGSqm727vZrYUq4",
            authDomain: "orenapp-f2f1e.firebaseapp.com",
            databaseURL: "https://orenapp-f2f1e-default-rtdb.firebaseio.com",
            projectId: "orenapp-f2f1e",
            storageBucket: "orenapp-f2f1e.firebasestorage.app",
            messagingSenderId: "973368909449",
            appId: "1:973368909449:web:ce364a309f622f575c3058"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // Ù…Ø¤Ù‚Øª Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø§ÙØªØªØ§Ø­ÙŠØ© (3 Ø«ÙˆØ§Ù†ÙŠ)
        setTimeout(() => {
            const sp = document.getElementById('splash');
            sp.style.opacity = '0';
            setTimeout(() => sp.style.display = 'none', 1000);
        }, 3000);

        function login() {
            const e = document.getElementById('emailInput').value;
            const p = document.getElementById('passInput').value;
            firebase.auth().signInWithEmailAndPassword(e, p).catch(err => alert(err.message));
        }

        firebase.auth().onAuthStateChanged(user => {
            const loginS = document.getElementById('loginScreen'), adminS = document.getElementById('adminScreen'), agentS = document.getElementById('agentScreen');
            if (user) {
                loginS.classList.add('hidden');
                if (user.email === "admin@oren.com") {
                    adminS.classList.remove('hidden'); loadAgents();
                } else {
                    agentS.classList.remove('hidden');
                    const n = user.email.split('@')[0];
                    db.ref('active_agents/' + n).set({name: n});
                    loadTasks(n);
                }
            } else {
                loginS.classList.remove('hidden'); adminS.classList.add('hidden'); agentS.classList.add('hidden');
            }
        });

        function loadAgents() {
            db.ref('active_agents').on('value', snap => {
                const s = document.getElementById('agentSelect');
                s.innerHTML = '<option value="">-- Ø§Ø®ØªØ± --</option>';
                snap.forEach(c => s.innerHTML += `<option value="${c.val().name}">${c.val().name}</option>`);
            });
        }

        function assignTask() {
            const ag = document.getElementById('agentSelect').value;
            if(!ag) return alert("Ø§Ø®ØªØ§Ø± Ù…Ù†Ø¯ÙˆØ¨");
            db.ref('orders_v9').push({
                customer: document.getElementById('cName').value,
                phone: document.getElementById('cPhone').value,
                addr: document.getElementById('cAddr').value,
                issue: document.getElementById('cIssue').value,
                to: ag
            }).then(() => { alert("ØªÙ…!"); document.getElementById('cName').value = ""; });
        }

        function loadTasks(name) {
            db.ref('orders_v9').on('value', snap => {
                const list = document.getElementById('tasksList'); list.innerHTML = "";
                snap.forEach(c => {
                    const t = c.val();
                    if(t.to === name) {
                        list.innerHTML += `<div class="task-card"><b>ğŸ‘¤ ${t.customer}</b><br>ğŸ“ ${t.phone}<br>ğŸ“ ${t.addr}<br>ğŸ“ ${t.issue}<br><button onclick="done('${c.key}')" style="width:100%; margin-top:10px; background:#2ed573; color:white; border:none; padding:5px; border-radius:5px; cursor:pointer;">ØªÙ… âœ…</button></div>`;
                    }
                });
            });
        }

        function done(id) { db.ref('orders_v9/' + id).remove(); }
        function logout() { firebase.auth().signOut(); }
    </script>
</body>
</html>
